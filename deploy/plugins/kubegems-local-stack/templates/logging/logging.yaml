{{- if .Values.logging.enabled -}}
# https://banzaicloud.com/docs/one-eye/logging-operator/install/#helm
apiVersion: plugins.kubegems.io/v1beta1
kind: Plugin
metadata:
  name: logging-operator
  namespace: "{{ .Release.Namespace }}"
spec:
  enabled: true
  kind: helm
  installNamespace: {{ .Values.logging.namespace }}
  repo: https://kubernetes-charts.banzaicloud.com
  version: {{ .Values.logging.operator.version }}
  values:
    image:
      # repository: ghcr.io/banzaicloud/logging-operator
      {{ include "common.images.repository" ( dict "registry" "ghcr.io" "repository" "banzaicloud/logging-operator" "context" .) }}
---
# https://github.com/grafana/helm-charts/tree/main/charts/loki
apiVersion: plugins.kubegems.io/v1beta1
kind: Plugin
metadata:
  name: loki-stack
  namespace: "{{ .Release.Namespace }}"
spec:
  enabled: true
  kind: helm
  installNamespace: {{ .Values.logging.namespace }}
  repo: https://grafana.github.io/helm-charts
  version: {{ .Values.logging.loki.version }}
  values:
    promtail: 
      image:
        # repository: docker.io/grafana/promtail
        {{ include "common.images.repository" ( dict "registry" "docker.io" "repository" "grafana/promtail" "context" .) }}
    loki: 
      image:
        # repository: docker.io/grafana/loki
        {{ include "common.images.repository" ( dict "registry" "docker.io" "repository" "grafana/loki" "context" .) }}
{{- end -}}